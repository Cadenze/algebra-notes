\chapter{Modules}\label{sec:modules}

\section{Basic Definitions}

\begin{definition}
    We recall from the previous chapter that
    a left module over a ring \(R\) is a quadruple \((M,+,\cdot,0)\)
    where \(0 \in M\) is a set equipped with addition \(+\)
    with an identity \(0\)
    and scalar multiplication,
    with the following four properties:
    \begin{enumerate}[label={(\roman*)}, itemsep=0mm]
        \item \((M,+,0)\) forms an abelian group;
        \item scalar multiplication
            \(\vfunc{\cdot}{R \times M}{M}{(\alpha,m)}{\alpha m}\),
            and in particular \(1m = m\);
        \item \(\forall\{\alpha,\beta\} \in R,\, \forall\{m,n\} \subset M\),
            the distributive laws \((\alpha+\beta)(m+n)
            = \alpha m+\alpha n+\beta m+\beta n\) hold; and
        \item associativity
            \(\forall\{\alpha,\beta\} \subset R,\,\forall m \in M\),
            \((\alpha\beta)m = \alpha(\beta m)\).
    \end{enumerate}
    A right module is similarly defined with the multiplication \(MR \subseteq M\) instead.
\end{definition}

\begin{definition}
    Suppose \(M\) is an \(R\)-module.
    \(M\) is generated by \(X \subseteq M\)
    if for any arbitrary \(m \in M\),
    there exists scalars \(a_i \in R\) and \(x_i \in X\) such that
    we have the finite sum \(m = \sum_i a_i x_i\).
\end{definition}

\begin{theorem}
    Suppose \(M\) is an abelian group.
    Then \(M\) is also:
    \begin{enumerate}[label={(\alph*)}, itemsep=0mm]
        \item a \(\bZ\)-module; and
        \item an \(R\)-module, where \(R = \End_\bZ(M)\).
    \end{enumerate}
\end{theorem}
\begin{proof}
    By definition, \(M\) is an abelian group.
    We can define scalar multiplication to be \(am = \underbrace{m+\cdots+m}_{a\,\text{times}}\),
    Then of course
    \begin{equation*}
        (a+b)(m+n) = \underbrace{(m+n)+\cdots+(m+n)}_{a+b\,\text{times}}
        = \underbrace{m+\cdots+m}_{a+b\,\text{times}} + \underbrace{n+\cdots+n}_{a+b\,\text{times}}
        = am + bm + an + bn
    \end{equation*}
    which is also obviously associative because
    \begin{equation*}
        (ab)m = \underbrace{m+\cdots+m}_{ab\,\text{times}}
        = \underbrace{bm+\cdots+bm}_{a\,\text{times}}
        = a(bm)
    \end{equation*}
    This proves part (a).

    For part (b), we have to first show that \(R = \End(M)\) is indeed a ring.
    Let \(\phi,\psi \in \End(M)\),
    and define addition as \((\phi+\psi)(m) = \phi(m)+\psi(m)\),
    and multiplication as function composition \((\phi\psi)(m) = (\phi\circ\psi)(m)\).
    Addition forms an abelian group,
    since the element-wise definition inherits closure, associativity, and commutativity,
    and the identity is defined trivially as the zero map \(m \mapsto 0\),
    so the inverse can be defined as \(m \mapsto -m\).
    Multiplication is associative by function composition,
    closure is inherited from \(M\),
    and identity is defined by \(m \mapsto m\).
    Distributivity is given by
    \begin{gather*}
        \phi(\psi+\chi)(m) = \phi(\psi(m)+\chi(m))
        = (\phi\circ\psi)(m) + (\phi\circ\chi)(m)
        = (\phi\psi+\phi\chi)(m)
    \end{gather*}

    Then, scalar multiplication can be defined as evaluation \(\phi m = \phi(m)\);
    and associativity holds by function composition.
    By the fact that we have homomorphisms,
    distributivity holds.
    \begin{equation*}
        (\phi+\psi)(m+n) = \phi(m+n) + \psi(m+n)
        = \phi(m) + \phi(n) + \psi(m) + \psi(n)
    \end{equation*}
    This proves part (b).
\end{proof}

% \begin{theorem}[Cayley's Theorem]
%     Suppose \(R\) is a ring,
%     and let \(M = (R,+,0)\) be its additive group, treated as a \(\bZ\)-module.
%     Then \(R \cong \End(M)\).
% \end{theorem}
% \begin{proof}
%     Consider \(\func{\ell_r}{m}{rm}\), and let us show that \(\ell_r \in \End_\bZ(M)\).
%     \begin{equation*}
%         \ell_r(am+n) = r(am+n) = a(rm)+rn = a\ell_r(m) + \ell_r(n)
%     \end{equation*}
%     Then we shall show that \(\vfunc{\phi}{R}{\End(M)}{r}{\ell_r}\) is an isomorphism.
%     Suppose \(\ell_r = \ell_s\).
%     Then for all \(m \in R\), \(\ell_r(m) = \ell_r(s)\),
%     and in particular, \(\ell_r(1) = r = s = \ell_r(1)\).
%     We have shown injectivity.
%     Suppose \(\phi \in \End(M)\), and that \(\phi(1) = r\).
%     We claim that \(\phi = \ell_r\),
%     and suppose, by way of contradiction, that it is not.
%     Then \(\phi - \ell_r \in \End(M)\) is a nonzero homomorphism,
%     so there exists some \(m \in M\) such that
%     \(\phi(m) - rm \neq 0\).
% \end{proof}
% \begin{remark}
%     This is the ring-theoretic analogue of
%     the \hyperref[thm:cayley]{group-theoretic Cayley's theorem}.
% \end{remark}

\begin{definition}
    Suppose \(M\) is an \(R\)-module.
    Then \(N \subseteq M\) is a submodule if:
    \begin{enumerate}[label={(\roman*)}, itemsep=0mm]
        \item \((N,+,0) \subseteq (M,+,0)\) is a subgroup; and
        \item for all \(r \in R\), \(rn \in N\).
    \end{enumerate}
\end{definition}
\begin{lemma}
    Suppose \(M\) is an \(R\)-module,
    and \(N \subseteq M\) is a submodule.
    Then \(M/N\) forms an \(R\)-module.
\end{lemma}
\begin{proof}
    Clearly \(M/N\) readily forms an additive quotient group,
    as Proposition~\ref{prop:abelian-subgroup-normal} informs us that abelian subgroups are normal.
    Then scalar multiplication is \(r(x+N) = rx + rN = rx + N\).
    Distributivity and associativity is then inherited from \(M\).
\end{proof}
\begin{corollary}
    \(\vfunc{\pi}{M}{M/N}{x}{x+N}\) is the quotient homomorphism.
\end{corollary}
\begin{proof}
    All properties are inherited.
\end{proof}

\begin{definition}
    Suppose \(M\) is an \(R\)-module. Then \(M\) is 
    \begin{enumerate}[label={(\roman*)}, itemsep=0mm]
        \item finitely generated if there exists \({\{x_i\}}_{i=1}^n \subset M\) that generates \(M\); and
        \item a cyclic module if it can be generated by one element.
    \end{enumerate}
\end{definition}
\begin{definition}
    Suppose \(R\) is a commutative integral domain,
    and \(M\) is an \(R\)-module.
    \begin{enumerate}[label={(\roman*)}, itemsep=0mm]
        \item \(M\) is a torsion module if for all \(m \in M\),
            there exists a nonzero \(r \in R\) such that \(rm = 0\).
        \item \(M\) is torsion-free if \(rm = 0\) implies either \(r = 0\) or \(m = 0\).
    \end{enumerate}
\end{definition}

\begin{proposition}
    Suppose \(R\) is a commutative ring, and \(M,N\) are \(R\)-modules.
    Then \(\Hom_R(M,N)\) is also an \(R\)-module.
\end{proposition}
\begin{proof}
    Clearly \(\Hom_R(M,N)\) forms an abelian group with
    \((\phi+\psi)(x) = \phi(x)+\psi(x)\),
    which guarantees associativity.
    The zero homomorphism is \(0(x) = 0\) for all \(x\),
    which gives us the inverse \((-\phi)(x) = -\phi(x)\).

    Scalar multiplication is \((r\phi)(x) = r\phi(x)\).
    Then our distributive laws hold with
    \((r+s)(\phi+\psi)(x) = (r+s)\phi(x) + (r+s)\psi(x) = r\phi(x) + s\phi(x) + r\psi(x) + s\psi(x)\).
    Associativity holds with \((rs)\phi(x) = rs\phi(x) = r(s\phi)(x)\).
\end{proof}
\begin{proposition}
    Suppose \(R\) is a commutative ring.
    The category \(\textbf{Mod}_R\) consisting of all \(R\)-modules
    and module homomorphisms form a category.
\end{proposition}
\begin{proof}
    Module homomorphisms compose and are associative,
    and the identity morphism is \(\id(x) = x\).
\end{proof}
\begin{proposition}
    Suppose \(M\) is an \(R\)-module.
    There exists a functor \(\textbf{Mod}_R \to \textbf{Mod}_R\)
    that maps \(N \mapsto \Hom_R(M,N)\)
    and maps \(\func{\phi}{N}{L}\) to \(\func{\tilde{\phi}}{\Hom_R(M,N)}{\Hom_R(M,L)}\).
\end{proposition}
\begin{proof}
    We can define \(\tilde{\phi}\) as \(\psi \mapsto \phi\circ\psi\).
    Then this obviously preserves composition,
    and identity \(\tilde{\id}\) is now \(\psi \mapsto \id\circ\psi = \psi\).
\end{proof}
\begin{proposition}
    \(\Hom_R(R,N) \cong N\).
\end{proposition}
\begin{proof}
    Consider some arbitrary \(n \in N\).
    We demonstrate that there exists only one homomorphism \(\phi_n \in \Hom_R(R,N)\)
    that maps \(1 \mapsto n\).
    This can be seen since for any \(r \in R\),
    \(\phi(r) = r\phi(1) = rn\) is uniquely defined.

    Now consider the homomorphism \(N \to \Hom_R(R,N)\),
    where \(n \mapsto \phi_n\).
    Injectivity is obvious, since \(\phi_m = \phi_n\) implies \(1 \mapsto m = n\).
    For surjectivity, consider any arbitrary \(\phi \in \Hom_R(R,N)\).
    It must map \(1\) to some element \(n \in N\),
    which allows us to immediately conclude that \(n \mapsto \phi = \phi_n\).
\end{proof}

\begin{definition}
    Suppose \(L\) is an \(R\)-module,
    and \(M,N \subseteq L\) are submodules.
    The quotient ideal \((M:N) = \{x \in R : xN \subseteq M\}\).
\end{definition}
\begin{definition}
    Suppose \(N\) is an \(R\)-module.
    The annihilator of \(N\) is \(\Ann_R(N) = (0:N) = \{x \in R : xN = 0\}\).
\end{definition}

\begin{definition}
    Suppose \({\{M_i\}}_{i \in S}\) is a family of \(R\)-modules.
    The direct product is \(\prod_i M_i = \{{(m_i)}_{i \in S}\}\),
    and the direct sum is \(\bigoplus_i M_i = \{{(m_i)_{i \in S}}\}\) with finite support.
\end{definition}


\section{Free Modules}

\begin{definition}
    Suppose \(M\) is an \(R\)-module.
    \(M\) is free if there is a basis \(X \subset M\);
    that is, \(X\) generates \(M\) (analogous to spanning)
    and \(X\) is linearly independent.
\end{definition}
\begin{remark}
    Throughout this chapter,
    we assume that any free module must be finitely generated;
    that is, they are free modules of finite rank.
\end{remark}
\begin{lemma}
    For any free \(R\)-module \(M\), \(M \cong R^n\).
\end{lemma}
\begin{proof}
    Consider the basis \({\{x_i\}}_{i=1}^n \subset M\).
    Let us construct the homomorphism \(\vfunc{\phi}{R^n}{M}{(a_1,\hdots,a_n)}{\sum a_i x_i}\).
    Linearity is obvious.
    \begin{equation*}
        \phi(c(a_1,\hdots,a_n)+(b_1,\hdots,b_n))
        = \sum (ca_i + b_i)x_i
        = c \sum a_i x_i + \sum b_i x_i
        = c\phi(a_1,\hdots,a_n) + \phi(b_1,\hdots,b_n)
    \end{equation*}
    Injectivity is given by linear independence.
    Surjectivity is given by spanning.
\end{proof}

\begin{lemma}\label{lem:free-module-homomorphism}
    Suppose \(M\) is a free \(R\)-module, \(N\) is any \(R\)-module,
    and \(X \subset M\) is a basis.
    Then \(\func{\phi}{M}{N}\) is wholly determined by the values \(\phi(x)\) for all \(x \in X\).
\end{lemma}
\begin{proof}
    Consider the basis \({\{x_i\}}_{i=1}^n \subset M\).
    If \(\phi(x_i) = \psi(x_i)\) for all \(x_i\),
    then any \(m = \sum a_i x_i\) must have an image
    \(\phi(m) = \sum a_i \phi(x_i) = \psi(m)\).
\end{proof}
\begin{theorem}
    Suppose \(M\) is a free \(R\)-module, and \(N\) is any \(R\)-module,
    and \(X \subset M\) is a basis.
    Given any \(x \in X\) and correspondingly \(n_x \in N\),
    there exists a unique \(\func{\phi}{M}{N}\) with \(\phi(x) = n_x\).
\end{theorem}
\begin{proof}
    The \hyperref[lem:free-module-homomorphism]{lemma above} proves existence.
    If there exists \(\phi \neq \psi\) that both fit this property,
    the \hyperref[lem:free-module-homomorphism]{lemma above}
    tells us that their images are the same.
\end{proof}
\begin{definition}
    Suppose \(\func{\phi}{R^n}{R^m}\) is a homomorphism between free \(R\)-modules.
    If \({\{x_i\}}_{i=1}^n \subset R^n\) is a basis,
    then we can write \(\phi(x_i) = (a_{1i},\hdots,a_{mi})\),
    and the entries \((a_{ij})\) is the matrix representation of \(\phi\).
\end{definition}

\begin{theorem}
    Suppose \(R\) is a (nontrivial) commutative ring.
    Then \(R^m \cong R^n\) implies \(m = n\).
\end{theorem}
\begin{proof}
    Let us have an isomorphism \(\func{\phi}{R^m}{R^n}\)
    Suppose, by way of contradiction, that \(m \neq n\).
    Without loss of generality let us assume that \(m < n\).
    There exists some inverse \(\func{\psi}{R^n}{R^m}\),
    and in particular, \(\phi\psi = \id\) on \(R^n\).
    But we know that we can extend \(\phi\) to some \(\func{\bar{\phi}}{R^m \oplus R^{n-m}}{R^n}\),
    with \(\eval{\bar{\phi}}_{R^{n-m}} = 0\),
    and similarly we can write \(\func{\bar{\psi}}{R^n}{R^m \oplus R^{n-m}}\)
    by padding it with zeroes.
    Let \(\bar{\phi}\) and \(\bar{\psi}\) have matrices \(\vb{A}\) and \(\vb{B}\) respectively.
    Then as \(\vb{A}\vb{B} = \vb{I}\), we have \((\det\vb{A})(\det\vb{B}) = 1\).
    But by construction, the padding of zeroes on \(\bar{\psi}\)
    is going to leave us with rows of zeroes on \(\vb{B}\),
    which implies \(\det\vb{B} = 0\).
    Hence \(0 = 1\), and we have reached a contradiction.
\end{proof}
\begin{remark}
    This proof only works for commutative rings,
    as the notion of a determinant does not exist without commutativity.
    On the other hand, there are noncommutative rings with an invariant basis number.
\end{remark}
\begin{corollary}
    Suppose \(F\) is a field.
    Then \(F^m \cong F^n\) implies \(m = n\).
\end{corollary}
\begin{proof}
    Fields are commutative rings.
\end{proof}
\begin{definition}
    The dimension of a vector space is the cardinality of its basis.
\end{definition}
\begin{remark}
    Any such ring with this property is said to have an invariant basis number,
    which means its rank is well-defined;
    this is analogous to the dimension vector space being well-defined.
\end{remark}

\begin{proposition}\label{prop:ideal-submodule}
    Consider the ring \(R\) as an \(R\)-module.
    Then the ideals of \(R\) are exactly the submodules of \(R\).
\end{proposition}
\begin{proof}
    Consider an ideal \(I \subseteq R\).
    Ideals are additively closed, and \(rI \subseteq I\) by definition of ring multiplication.
    Hence \(I \subseteq R\) is a submodule.
    The reverse argument holds exactly the same way.
\end{proof}


\section{Isomorphism Theorems}

\begin{theorem}[Universal Property of Quotient Submodules]\label{thm:univ-prop-quotient-mod}
    Let \(M,N\) be \(R\)-modules, and \(K \subseteq M\) be a submodule.
    Suppose \(\func{\pi}{M}{M/K}\) is the quotient homomorphism
    and \(\func{\phi}{M}{N}\) is any module homomorphism, with \(K \subseteq \ker\phi\).
    Then there exists a unique module homomorphism \(\func{\bar{\phi}}{M/K}{N}\)
    such that \(\phi = \bar{\phi}\circ\pi\).

    This is represented by the following commutative diagram:
    \begin{center}
        \begin{tikzcd}
            M \arrow{r}{\phi} \arrow{d}{\pi} & N \\
            M/K \arrow[dashrightarrow]{ru}[swap]{\exists! \bar{\phi}}
        \end{tikzcd}
    \end{center}
\end{theorem}
\begin{proof}
    We first assume that \(\bar{\phi}\) exists and attempt to prove its uniqueness.
    Suppose \(\phi = \bar{\phi}\circ\pi = \bar{\phi}'\circ\pi\).
    Since \(K \subseteq \ker\phi\),
    all elements \(k \in K\) obey \(\phi(k) = 0\).
    Knowing all elements in \(M\) belong in some coset \(m+K\),
    all \(m' \in m+K\) maps to \(\phi(m') = \phi(m+k) = \phi(m) + \phi(k) = \phi(m)\),
    which tells us the image of each coset is \(\phi(m+K) = \{\phi(m)\}\).
    Now, seeing that \(\pi\) maps \(m' \mapsto m+K\),
    by definition of a quotient mapping,
    if \(\bar{\phi}\neq\bar{\phi}'\),
    there must be one such coset \(m+K\) that
    \(\bar{\phi}(m+K) \neq \bar{\phi}'(m+K)\) disagrees on.
    However, this is a contradiction,
    because for all \(m' \in m+I \subseteq M\),
    \(\bar{\phi}'(m+K) = \bar{\phi}'(\pi(m')) = \phi(m') = \bar{\phi}(\pi(m')) = \bar{\phi}(m+K)\),
    contradicting the inequality that we have above.
    Hence we have established uniqueness of \(\bar{\phi}\).

    We will now prove existence by constructing such a homomorphism.
    Let \(\vfunc{\bar{\phi}}{M/K}{N}{m+K}{\phi(m)}\).
    Suppose some arbitrary element \(m' \in m+K \subseteq M\) is in an arbitrary coset.
    Then we know that there exists \(k \in K\) such that \(m' = m+k\),
    which gives us
    \begin{equation*}
        \phi(m') = \phi(m+k) = \phi(m)+\phi(k) = \phi(m)
        = \bar{\phi}(m+K) = \bar{\phi}(\pi(m'))
    \end{equation*}
\end{proof}

\begin{theorem}[First Isomorphism Theorem for Modules]\label{thm:iso-1-mod}
    Suppose \(\func{\phi}{M}{N}\) is an \(R\)-module homomorphism,
    and \(K = \ker\phi\). We have:
    \begin{enumerate}[label={(\alph*)}, itemsep=0mm]
        \item \(K \subseteq M\), the kernel is a submodule;
        \item \(\img\phi \subseteq N\), the image is a submodule; and
        \item \(\img\phi \cong M/K\), the image is uniquely isomorphic to the quotient submodule.
    \end{enumerate}
    This is represented by the following commutative diagram:
    \begin{center}
        \begin{tikzcd}
            M \arrow{rd}{\phi} \arrow{d}{\pi} & N \\
            M/K \arrow{r}{\cong} & \img\phi \arrow[dash]{u}
        \end{tikzcd}
    \end{center}
\end{theorem}
\begin{proof}
    Suppose \(\{x,y\} \subset \ker\phi\).
    Then \(\phi(rx+y) = \phi(rx) + \phi(y) = r\phi(x) + \phi(y) = 0\).
    This proves part (a).

    \medskip

    Now suppose \(\{\phi(x),\phi(y)\} \subset \img\phi\).
    Then \(r\phi(x)+\phi(y) = \phi(rx)+\phi(y) = \phi(rx+y)\).
    This proves part (b).

    \medskip

    By the \hyperref[thm:univ-prop-quotient-mod]{universal property},
    we have a unique homomorphism \(\vfunc{\bar{\phi}}{M/K}{\img\phi}{m+K}{\phi(m)}\),
    which is surjective by definition of image.
    If we have \(\bar{\phi}(m+K) = \bar{\phi}(n+K)\),
    then \(\phi(m) = \phi(n)\),
    so \(m-n \in \ker\phi = K\),
    and they must be from the same coset,
    which proves injectivity.
    We have statement (c).
\end{proof}

\begin{theorem}[Second Isomorphism Theorem for Modules]\label{thm:iso-2-mod}
    Suppose \(M\) is an \(R\)-module,
    and \(N,P \subseteq M\) are submodules.
    We have:
    \begin{enumerate}[label={(\alph*)}, itemsep=0mm]
        \item \(N+P = \{n+p: n \in N,\, s \in S\} \subseteq M\), the sum is a subring;
        \item \(P \subseteq N+P\), the summands are submodules of the sum;
        \item \(N \cap P \subseteq N\), the intersection is a submodule; and
        \item \((N+P)/P \cong N/(N \cap P)\), these two quotients are isomorphic.
    \end{enumerate}

    This is represented by the following commutative diagram:
    \begin{center}
        \begin{tikzcd}
            M \arrow[dash]{d} \\
            N+P \arrow[dash]{d} \arrow{r}{\pi} \arrow[dash]{rd} &
            (N+P)/P \arrow[leftrightarrow]{rd}{\cong} \\
            P \arrow[dash]{rd} & N \arrow{r}{\pi'} \arrow[dash]{d} &
            N/(N \cap P) \\
            & N \cap P
        \end{tikzcd}
    \end{center}
\end{theorem}
\begin{proof}
    By the \hyperref[thm:iso-2-group]{second group isomorphism theorem},
    \(N+P\) already forms an additive group.
    Scalar multiplication is inherited directly from distribution in \(M\).
    This proves statement (a).

    \medskip

    There is an embedding \(\vfunc{\iota}{P}{N+P}{p}{0+p}\).
    Injectivity is obvious because if \(0+p = 0\), then \(p=0\).
    This proves statement (b).

    \medskip

    If \(N \cap P\) is a module,
    then the natural embedding of \(N \cap P \to N\) gives us the submodule.
    Hence it suffices to check that the intersection forms a module.
    By the \hyperref[thm:iso-2-group]{second group isomorphism theorem},
    \(N \cap P\) already forms an additive group.
    Scalar multiplication is inherited each from \(N\) and \(P\).
    This proves statement (c).

    \medskip

    By statements (b) \& (c), the two quotients here are well-formed.
    We now attempt to construct a homomorphism \(\vfunc{\phi}{N}{(N+P)/P}{n}{n+P}\).
    We demonstrate that this is a valid homomorphism, by showing that
    \begin{equation*}
        \phi(r(m+n)) = r(m+n) + P = (rm+P) + (rn+P)
        = r((m+P) + (n+P)) = r(\phi(m)+\phi(n))
    \end{equation*}

    We now want to show that \(\phi\) is surjective.
    The elements \(n+p \in N+P\) must belong to some coset \(n+p+P\),
    which we see is equivalent to \(n+P\).
    By definition, \(\phi\) maps \(n \mapsto n+P\),
    and we have surjectivity.

    We can then demonstrate that \(\ker\phi = N \cap P\).
    We can then see that if \(x \in N \cap P\),
    then \(x \in P\), so \(\phi(x) = x+P = P\),
    which gives us that \(N \cap P \subseteq \ker\phi\).
    On the other hand, if \(x \in \ker\phi\),
    then \(\phi(x) = x+P \subseteq P\),
    which implies \(x \in P\),
    giving the reverse inclusion.
    This proves statement (d).
\end{proof}

\begin{theorem}[Third Isomorphism Theorem for Modules]\label{thm:iso-3-mod}
    Suppose \(M\) is an \(R\)-module,
    and \(N \subseteq M\) is a submodule.
    Then:
    \begin{enumerate}[label={(\alph*)}, itemsep=0mm]
        \item if \(L\) is a submodule such that \(N \subseteq L \subseteq M\),
            then \(L/N \subseteq M/N\) is a submodule;
        \item a submodule of \(M/N\) must be of the form \(L/N\)
            such that \(L\) is a submodule with \(N \subseteq L \subseteq M\); and
        \item if \(L\) is a submodule such that \(N \subseteq L \subseteq M\),
            then \((M/N)/(L/N) \cong M/L\).
    \end{enumerate}

    This is represented by the following commutative diagrams:
    \begin{center}
        \begin{tikzcd}
            M \arrow{r} \arrow[dash]{d} \arrow{rd} &
            M/L \arrow[leftrightarrow]{rd}{\cong} \\
            L \arrow[dash]{rd} & M/N \arrow{r} \arrow{d} & (M/N)/(L/N) \\
            & L/N
        \end{tikzcd}
    \end{center}
\end{theorem}
\begin{proof}
    We first see that \(N\) is also a submodule of \(L\),
    so that \(M/N\) and \(L/N\) are both well-formed.
    It is now easy to see that under the quotient homomorphism \(\func{\pi}{M}{M/N}\),
    \(L \mapsto L/N\),
    so by the \hyperref[thm:iso-1-mod]{first isomorphism theorem},
    \(L/N\) is a submodule.
    This proves statement (a).

    \medskip

    Consider a submodule \(L' \subseteq M/N\).
    Since \(0 \in L'\),
    the preimage \(\pi^{-1}(L') \supseteq \ker\pi = N\).
    Notice that the preimage is a submodule \(L\),
    as we have for \(x,y \in \pi^{-1}(L') = L\),
    \(\pi(rx+y) = r\pi(x) + \pi(y) \in L'\).
    Hence we have \(L' = \pi(L) = L/N\).
    This proves statement (b).

    \medskip

    We can now attempt to construct a homomorphism \(\func{\phi}{M/N}{M/L}\).
    by sending \(m+N \mapsto m+L\).
    This is valid because by the \hyperref[thm:univ-prop-quotient-mod]{universal property},
    given \(\func{\pi}{M}{M/N}\) and \(\func{\eta}{M}{M/L}\),
    there exists a unique homomorphism \(\phi\)
    such that \(\eta = \phi\circ\pi\).
    This is surjective by Theorem~\ref{thm:composite-surjective}.

    We claim that the kernel is \(\ker\phi = L/N\).
    Observe that \(\ker\eta = L\) and \(\ker\pi = N\),
    so \(\phi\) must map all the \(N\)-cosets that are represented by elements of \(L\) into 0.

    Lastly, we invoke the \hyperref[thm:iso-1-mod]{first isomorphism theorem},
    which gives us \((M/N)/(L/N) \cong M/L\) as desired.
    This proves statement (c).
\end{proof}

\begin{theorem}[Fourth Isomorphism Theorem for Modules]\label{thm:iso-4-mod}
    Suppose \(M\) is an \(R\)-module,
    and \(N \subseteq M\) is a submodule,
    with \(\func{\pi}{M}{M/N}\) being the quotient homomorphism.
    Then \(\pi\) is a bijection between the submodules of \(M/N\)
    and the submodules of \(M\) containing \(N\).
\end{theorem}
\begin{proof}
    This is merely a corollary of the \hyperref[thm:iso-3-mod]{third isomorphism theorem}.
    Statements (a) and (b) prove such a correspondence of submodules.
\end{proof}


% Put extra stuff from Commutative Algebra here

\section{Modules over Principal Ideal Domains}

\subsection*{Structure Theorems}

\begin{theorem}\label{thm:pid-submodule-free}
    Suppose \(R\) is a PID,
    and \(M \subseteq R^n\) is a submodule.
    Then \(M \cong R^m\) is free of rank \(m \leq n\).
    Additionally, there exists a basis \({\{y_i\}}_{i=1}^n \subset R^n\)
    such that \({\{a_i y_i\}}_{i=1}^m \subset M\) forms a basis,
    with \(a_i \mid a_{i+1}\).
\end{theorem}
\begin{proof}
    We can immediately move away from the trivial case of \(M = \{0\}\).
    Consider any module homomorphism \(\func{\phi}{R^n}{R}\).
    By the \hyperref[thm:iso-1-mod]{first isomorphism theorem}
    the image of the submodule \(\phi(M) \subseteq R\) is a submodule,
    which by Proposition~\ref{prop:ideal-submodule} we know is an ideal.
    But as \(R\) is a PID,
    this ideal is generated by a single element \(\phi(M) = (a_\phi)\).
    Let the set of all such ideals stemming from all such homomorphisms be
    \(\Sigma = \{(a_\phi): \phi \in \Hom(R^n,R)\}\).
    This set is not empty, because for the zero homomorphism \((0) \in \Sigma\).
    By Corollary~\ref{cor:noetherian-generated}, a PID is a Noetherian ring,
    so the set of ideals of \(R\) satisfies the ascending chain condition,
    and by \hyperref[ax:zorn]{Zorn's lemma},
    there exists a maximal element \((a_\mu) \in \Sigma\).
    Let \(a_1 = a_\mu\), and suppose \(x \in M\) is the element such that \(\mu(x) = a_1\).

    We now show that \(a_1 \neq 0\).
    Suppose, by way of contradiction, that it is zero.
    Consider some basis \({\{x_i\}}_{i=1}^n \subset R^n\).
    There are natural projection homomorphisms \(\func{\pi_i}{R^n}{R}\).
    But then this would require \(\pi_i(M) = 0\),
    which implies that \(M = \{0\}\),
    contradicting our initial assumption.

    We then show that for all \(\phi \in \Hom(R^n,R)\), \(\phi(x) \in (a_1)\).
    Consider the ideal generated by two elements \((a_1,\phi(x))\).
    Since we are in a PID, this can be written as \((a_1,\phi(x)) = (d)\),
    where \(d\) is a generator for this ideal.
    By equality, we have \(d = r_1a_1 + r_2\phi(x)\) and \((a_1) \subseteq (d)\).
    for some \(r_1,r_2,s_1,s_2 \in R\).
    We can write down a homomorphism \(\vfunc{\psi}{R^n}{R}{r}{r_1\mu(r) + r_2\phi(r)}\),
    which in particular sends \(x \mapsto r_1\mu(x) + r_2\phi(x) = d\).
    But this exactly tells us that \(d \in \psi(M)\) and \((a_1) \subseteq (d) \subseteq \psi(M)\).
    By maximality of \((a_1)\), \((a_1) = (d)\), and hence \(a_1 \mid d\).
    Then we have \(a_1 \mid \phi(x)\).

    Specifically applying the results of the previous paragraph to the projections \(\pi_i\)
    yields us that \(a_1 \mid \pi_i(x)\),
    so there exists some \(b_i\) such that \(\pi_i(x) = a_1b_i\).
    Let us define \(y_1 = \sum b_i x_i\).
    We now know that \(a_1y_1 = a_1 \sum_i b_i x_i = \sum_i \pi_i(x) x_i = x\).
    Hence \(a_1 = \mu(x) = \mu(a_1 y_1) = a_1 \mu(y_1)\) implies that \(\mu(y_1) = 1\).

    We claim that \(R^n = Ry_1 \oplus \ker\mu\).
    Consider any arbitrary \(r \in R^n\).
    We can write \(r = \mu(r)y_1 + (r - \mu(r)y_1)\),
    where the first part is in \(\mu(r)y_1 \in Ry_1\).
    But we can see that \(\mu(r-\mu(r)y_1) = \mu(r) - \mu(r)\mu(y_1) = \mu(r) - \mu(r) = 0\).
    so \((r - \mu(r)y_1) \in \ker\mu\).
    This representation is unique (as in this sum is direct)
    because if \(ry_1 \in \ker\mu\),
    then \(0 = r\mu(y_1) = r\) tells us that this element must be zero.
    
    We shall similarly claim that \(M = Ra_1y_1 \oplus (M \cap \ker\mu)\).
    Consider any arbitrary \(r \in M\).
    We know that \(a_1 \mid \mu(r)\) since \(\mu(M) = (a_1)\),
    so we can write \(\mu(r) = ba_1\) for some \(b \in R\).
    We have the decomposition \(r = \mu(r)y_1 + (r - \mu(r)y_1) = ba_1y_1 + (r-ba_1y_1)\),
    which again we know that the first part is is \(Ra_1y_1\),
    and the second part is in \(M \cap \ker\mu\) from above.
    Uniqueness is similarly given by above.

    We can finally prove that \(M \cong R^m\) is free.
    If \(M\) has rank 0, then \(M = \{0\}\) and we are done.
    Now we can demonstrate the rest via induction.
    If \(M\) has rank \(m > 0\),
    we can assume that \(M \cap \ker\mu\) is free of rank \(m-1\),
    so after adding \(a_1y_1\) to the basis we are done.

    Similarly we can prove the basis via induction.
    We can immediately see that \(\ker\mu\) is free,
    so there is a basis \({\{y_i\}}_{i=2}^n\),
    and its submodule \(N \cap \ker\mu\) has another basis \({\{a_i y_i\}}_{i=2}^m\) by induction.
    Hence we can simply append \(y_1\) and \(a_1 y_1\) to each of the bases as desired.
    It now suffices to prove that \(a_1 \mid a_2\).
    Take a homomorphism \(\phi\) such that \(\phi(y_1) = \phi(y_2) = 1\),
    and all other \(\phi(y_i) = 0\).
    We see that \(a_1 = \phi(a_1 y_1)\), so \((a_1) \subseteq \phi(M)\),
    and by maximality we have \((a_1) = \phi(M)\).
    But then \(a_2 = \phi(a_2 y_2) \in \phi(M) = (a_1)\)
    so we have our desired divisibility.
\end{proof}

\begin{theorem}[Existence of Invariant Factor Form]\label{thm:structure-invariant}
    Suppose \(R\) is a PID,
    and \(M\) is a finitely generated \(R\)-module.
    Then we can write our module as a direct sum of free and torsion parts,
    \(M \cong R^s \oplus \bigoplus_{i=1}^r R/(a_i)\), where \(a_i \mid a_{i+1}\).
    This decomposition is unique.
\end{theorem}
\begin{proof}
    Suppose \(M\) is generated by the set \({\{w_i\}}_{i=1}^n\).
    Then there exists a homomorphism \(\vfunc{\phi}{R^n}{M}{(r_1,\hdots,r_n)}{\sum r_i w_i}\),
    which is surjective by definition of generation.
    Hence by the \hyperref[thm:iso-1-mod]{first homomorphism theorem},
    \(M \cong R^n/\ker\phi\).

    From the \hyperref[thm:pid-submodule-free]{theorem above},
    we see that \(\ker\phi\) is free of rank \(m \leq n\),
    and we have the two bases \({\{x_i\}}_{i=1}^n \subset R^n\)
    and \({\{a_i x_i\}}_{i=1}^m \subset \ker\phi\).
    Hence we can write \(M \cong (Rx_1 \oplus \cdots \oplus Rx_n)/(Ra_1x_1 \oplus \cdots \oplus Ra_mx_m)\).

    We now use the natural homomorphism \(R^n \to R/(a_1) \oplus \cdots \oplus R/(a_m) \oplus R^{n-m}\),
    by sending \((r_1,\hdots,r_n) \mapsto (r_1+(a_1),\hdots,r_m+(a_m),r_{m+1},\hdots,r_n)\),
    using the quotient homomorphisms of the first \(m\) components.
    We show that \(\ker\phi\) is indeed also the kernel of this map.
    Clearly \(Ra_1x_1 \oplus \cdots \oplus Ra_mx_m\)
    is equivalent to the ideals \((a_i) \subseteq Rx_i\).
    Hence we have \(M \cong \bigoplus_{i=1}^m R/(a_i) \oplus R^{n-m}\) as desired.

    Uniqueness will be proven in the \hyperref[thm:structure-divisor]{theorem below}.
\end{proof}

\begin{theorem}[Existence of Elementary Divisor Form]\label{thm:structure-divisor}
    Suppose \(R\) is a PID,
    and \(M\) is a finitely generated \(R\)-module.
    Then we can write our module as a direct sum of free and torsion parts,
    \(M \cong R^s \oplus \bigoplus_{i=1}^r R/(p_i^{\alpha_i})\),
    where \(p_i \in R\) are (potentially non-distinct) primes.
    This decomposition is unique up to reordering of prime powers.
\end{theorem}
\begin{proof}
    As \(R\) is a PID, \hyperref[thm:pid-ufd]{which is a UFD},
    we have, uniquely, for each \(a_i = up_1^{\alpha_1} \hdots p_r^{\alpha_r}\),
    where \(u\) is a unit and \(p_i\) are primes.
    Then we clearly have
    \begin{equation*}
        R/(a_i) = R/\prod (p_i^{\alpha_i})
        = \prod_i R/(p_i^{\alpha_i})
    \end{equation*}
    by the \hyperref[thm:chinese]{Chinese remainder theorem}.
    Hence for each invariant factor decomposition,
    we have a elementary divisor decomposition (this form).

    On the other hand, consider an elementary divisor decomposition
    \(\prod_{ij} R/(p_i^{\alpha_{ij}})\), where \(p_i\) are distinct,
    and \(\alpha_{ij} \geq \alpha_{i(j+1)}\).
    Then by divisibility of the invariant factor decompostion,
    the largest \(a_n\) can be associated with \(\prod_i R/(p_i^{\alpha_{i1}})\),
    and then inductively creating the smaller \(a_n\).
    Hence we have a unique way to translate between the two forms.
\end{proof}

\begin{definition}
    \(\Tor(M)\) is the torsion part of \(M\),
    i.e.\ \(\Tor(M) \cong \bigoplus_{i=1}^r R/(a_i) \cong \bigoplus_{i=1}^r R/(p_i^{\alpha_i})\).
\end{definition}

\begin{theorem}[Uniqueness of Forms]\label{thm:structure-uniqueness}
    Suppose \(R\) is a PID,
    and \(M,N\) are finitely generated \(R\)-modules.
    Then \(M \cong N\) if and only if they have the same free rank
    and the same list of invariant factors or elementary divisors.
\end{theorem}
\begin{proof}
    Suppose \(M \cong N\).

    The reverse direction is obvious.
\end{proof}

\subsection*{Canonical Forms}
